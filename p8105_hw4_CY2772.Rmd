---
title: "p8105_hw4_CY2772"
author: "Chenhui Yan"
date: "2024-11-14"
output: github_document
---
```{r}
library(tidyverse)

library(broom)
library(purrr)
```

# Problem 1: Birthday problem
```{r}
# Create the simulation function
simulate_birthday = function(n) {
  birthdays <- sample(1:365, size = n, replace = TRUE)
  any(duplicated(birthdays))
}
```
```{r}
# Run the simulation for each group size
set.seed(123)  # For reproducibility

group_sizes = 2:50
num_simulations = 10000

probabilities = sapply(group_sizes, function(n) {
  results = replicate(num_simulations, simulate_birthday(n))
  mean(results)
})
```


```{r}
# Plot the probabilities

plot_data = data.frame(
  group_size = group_sizes,
  probability = probabilities
)

ggplot(plot_data, aes(x = group_size, y = probability)) +
  geom_line(color = "blue") +
  geom_point(color = "red") +
  labs(
    title = "Probability of At Least Two People Sharing a Birthday",
    x = "Group Size",
    y = "Probability"
  ) +
  theme_minimal() +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1))

```

The plot shows a sigmoid-like curve, starting very low for small groups and then rapidly increasing around group sizes of 20-30, and then leveling off near 1 (100%) for group sizes approaching 50.





